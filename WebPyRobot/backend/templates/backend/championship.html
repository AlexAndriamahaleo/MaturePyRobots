{% extends "base.html" %}

{% load staticfiles %}

{% block title %}
    PyRobot - Championnats
{% endblock %}

{% block custom_css %}

{% endblock %}

{% block content %}
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <h4>Liste des championnats disponible</h4>
                <nav class="indigo darken-4">
                    <div class="nav-wrapper">
                        <form>
                            <div class="input-field">
                                <input id="searchChamp" type="search" onkeyup="searchChamp()" required>
                                <label class="label-icon" for="searchChamp"><i class="material-icons">search</i></label>
                                <i class="material-icons">close</i>
                            </div>
                        </form>
                    </div>
                </nav>
                <ul id="resultChamp">
                    {% for champ in all_championship %}
                        <li>
                            <p>{{ champ.name }} avec {{ champ.players.all|length }} joueur(s)
                                <span class="badge">
                                    <a class=" modal-trigger btn-floating red" href="#confirmleague"  data-champpk="{{ champ.pk }}">
                                        <i id="{{ champ.name }}" class="championship large material-icons">chevron_right</i>
                                    </a>
                                </span>
                            </p>
                        </li>
                    {% endfor %}
                </ul>
            </div>
            <div class="col s12 m12 l12">
                <form action="" method="post">
                    {% csrf_token %}
                    <h4>Cr√©er un championnat</h4>
                    <div class="row">
                        <div class="input-field col s12">
                            {{ form.name }}
                            <label for="{{ form.name.label }}">{{ form.name.label }}</label>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <input type="submit" value="Go" class=" modal-action waves-effect indigo darken-4 btn">
                    </div>
                </form>
            </div>
        </div>
        <div id="confirmleague" class="modal">
            <div class="modal-content">
                <h4>Confirmation</h4>
                <p id="modalconfirmation"></p>
            </div>
            <div class="modal-footer">
                <form action="{% url 'backend:change_championship' %}" method="POST">
                    {% csrf_token %}
                    <input id="modalconfirmation2" type="hidden" name="champ_name" />
                    <input type="submit" class="modal-action modal-close waves-effect waves-green btn-flat" value="Oui"/>
                    <a class="modal-action modal-close waves-effect waves-green btn-flat">Non</a>
                </form>
            </div>
        </div>
    </div>
{% endblock %}

{% block custom_js %}
<script>
    function searchChamp() {
      var input, filter, table, li, p, i;
      input = document.getElementById("searchChamp");
      filter = input.value.toUpperCase();
      table = document.getElementById("resultChamp");
      li = table.getElementsByTagName("li");
      for (i = 0; i < li.length; i++) {
        p = li[i].getElementsByTagName("p")[0];
        if (p) {
          if (p.innerHTML.toUpperCase().indexOf(filter) > -1) {
            li[i].style.display = "";
          } else {
            li[i].style.display = "none";
          }
        }
      }
    }
</script>
{% endblock %}